Running evaluation at Mon Apr 21 19:21:15 JST 2025:
CUDA_VISIBLE_DEVICES=0     python3 src/evaluate_captioning.py     --model_path ./outputs/llava-datikz-lora/llava-datikz-full     --output_json ./results/llava-datikz-trained_testdata.json
[info] Loading model from './outputs/llava-datikz-lora/llava-datikz-full' to device cuda:0...
Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|███▎      | 1/3 [00:01<00:02,  1.28s/it]Loading checkpoint shards:  67%|██████▋   | 2/3 [00:02<00:01,  1.01s/it]Loading checkpoint shards: 100%|██████████| 3/3 [00:07<00:00,  2.97s/it]Loading checkpoint shards: 100%|██████████| 3/3 [00:07<00:00,  2.47s/it]
Using `use_fast=True` but `torchvision` is not available. Falling back to the slow image processor.
[info] Loading processor (use_fast=True)...
✅ Model and processor loaded successfully!
==========================================================================================
Layer (type:depth-idx)                                            Param #
==========================================================================================
LlavaForConditionalGeneration                                     --
├─CLIPVisionModel: 1-1                                            --
│    └─CLIPVisionTransformer: 2-1                                 --
│    │    └─CLIPVisionEmbeddings: 3-1                             1,193,984
│    │    └─LayerNorm: 3-2                                        2,048
│    │    └─CLIPEncoder: 3-3                                      302,309,376
│    │    └─LayerNorm: 3-4                                        2,048
├─LlavaMultiModalProjector: 1-2                                   --
│    └─Linear: 2-2                                                4,198,400
│    └─GELUActivation: 2-3                                        --
│    └─Linear: 2-4                                                16,781,312
├─LlamaForCausalLM: 1-3                                           --
│    └─LlamaModel: 2-5                                            --
│    │    └─Embedding: 3-5                                        131,334,144
│    │    └─ModuleList: 3-6                                       6,476,267,520
│    │    └─LlamaRMSNorm: 3-7                                     4,096
│    │    └─LlamaRotaryEmbedding: 3-8                             --
│    └─Linear: 2-6                                                131,334,144
==========================================================================================
Total params: 7,063,427,072
Trainable params: 7,063,427,072
Non-trainable params: 0
==========================================================================================
[info] Generating captions...
✅ DatikzCaptionDataset initialized with 4830 samples for split 'test'
  0%|          | 0/4830 [00:00<?, ?it/s]  0%|          | 1/4830 [00:03<4:55:31,  3.67s/it]  0%|          | 2/4830 [00:04<3:02:00,  2.26s/it]  0%|          | 3/4830 [00:06<2:27:03,  1.83s/it]  0%|          | 4/4830 [00:08<2:29:22,  1.86s/it]  0%|          | 5/4830 [00:09<2:06:31,  1.57s/it]  0%|          | 6/4830 [00:10<1:58:51,  1.48s/it]  0%|          | 7/4830 [00:12<2:00:21,  1.50s/it]  0%|          | 8/4830 [00:13<2:02:15,  1.52s/it]  0%|          | 9/4830 [00:15<2:18:17,  1.72s/it]  0%|          | 10/4830 [00:17<2:23:26,  1.79s/it]  0%|          | 11/4830 [00:20<2:39:48,  1.99s/it]  0%|          | 12/4830 [00:22<2:50:58,  2.13s/it]  0%|          | 13/4830 [00:25<2:58:52,  2.23s/it]  0%|          | 14/4830 [00:27<3:04:19,  2.30s/it]  0%|          | 15/4830 [00:29<3:08:04,  2.34s/it]  0%|          | 16/4830 [00:31<2:36:40,  1.95s/it]  0%|          | 17/4830 [00:32<2:24:57,  1.81s/it]  0%|          | 18/4830 [00:33<2:15:04,  1.68s/it]  0%|          | 19/4830 [00:35<2:09:27,  1.61s/it]  0%|          | 20/4830 [00:37<2:22:29,  1.78s/it]  0%|          | 21/4830 [00:37<1:46:06,  1.32s/it]  0%|          | 22/4830 [00:38<1:39:13,  1.24s/it]  0%|          | 23/4830 [00:41<2:08:28,  1.60s/it]  0%|          | 24/4830 [00:42<1:57:10,  1.46s/it]  1%|          | 25/4830 [00:43<1:55:37,  1.44s/it]  1%|          | 26/4830 [00:44<1:49:13,  1.36s/it]  1%|          | 27/4830 [00:46<1:42:56,  1.29s/it]  1%|          | 28/4830 [00:46<1:18:29,  1.02it/s]  1%|          | 29/4830 [00:47<1:21:41,  1.02s/it]  1%|          | 30/4830 [00:48<1:21:46,  1.02s/it]  1%|          | 31/4830 [00:50<1:56:13,  1.45s/it]  1%|          | 32/4830 [00:53<2:20:20,  1.75s/it]  1%|          | 33/4830 [00:55<2:37:15,  1.97s/it]  1%|          | 34/4830 [00:56<2:14:20,  1.68s/it]  1%|          | 35/4830 [00:58<2:04:50,  1.56s/it]  1%|          | 36/4830 [00:59<2:05:29,  1.57s/it]  1%|          | 37/4830 [01:00<1:54:15,  1.43s/it]  1%|          | 38/4830 [01:03<2:18:16,  1.73s/it]  1%|          | 39/4830 [01:05<2:35:46,  1.95s/it]  1%|          | 40/4830 [01:08<2:47:22,  2.10s/it]  1%|          | 41/4830 [01:09<2:37:50,  1.98s/it]  1%|          | 42/4830 [01:12<2:49:26,  2.12s/it]  1%|          | 43/4830 [01:14<2:45:00,  2.07s/it]  1%|          | 44/4830 [01:16<2:53:44,  2.18s/it]  1%|          | 45/4830 [01:19<3:00:30,  2.26s/it]  1%|          | 46/4830 [01:19<2:23:14,  1.80s/it]  1%|          | 47/4830 [01:20<2:01:57,  1.53s/it]  1%|          | 48/4830 [01:21<1:52:02,  1.41s/it]  1%|          | 49/4830 [01:23<1:51:31,  1.40s/it]  1%|          | 50/4830 [01:24<1:41:45,  1.28s/it]  1%|          | 51/4830 [01:25<1:44:13,  1.31s/it]  1%|          | 52/4830 [01:28<2:11:51,  1.66s/it]  1%|          | 53/4830 [01:30<2:31:04,  1.90s/it]  1%|          | 54/4830 [01:31<2:12:04,  1.66s/it]  1%|          | 55/4830 [01:32<2:01:06,  1.52s/it]  1%|          | 56/4830 [01:34<1:57:31,  1.48s/it]  1%|          | 57/4830 [01:36<2:21:00,  1.77s/it]  1%|          | 58/4830 [01:39<2:37:25,  1.98s/it]  1%|          | 59/4830 [01:41<2:48:14,  2.12s/it]  1%|          | 60/4830 [01:42<2:24:35,  1.82s/it]  1%|▏         | 61/4830 [01:45<2:39:56,  2.01s/it]  1%|▏         | 62/4830 [01:46<2:18:03,  1.74s/it]  1%|▏         | 63/4830 [01:47<2:10:03,  1.64s/it]  1%|▏         | 64/4830 [01:50<2:29:47,  1.89s/it]  1%|▏         | 65/4830 [01:52<2:28:00,  1.86s/it]  1%|▏         | 66/4830 [01:54<2:42:18,  2.04s/it]  1%|▏         | 67/4830 [01:55<2:25:42,  1.84s/it]  1%|▏         | 68/4830 [01:57<2:13:58,  1.69s/it]  1%|▏         | 69/4830 [01:59<2:32:29,  1.92s/it]  1%|▏         | 70/4830 [02:00<2:15:41,  1.71s/it]  1%|▏         | 71/4830 [02:03<2:33:40,  1.94s/it]  1%|▏         | 72/4830 [02:05<2:32:31,  1.92s/it]  2%|▏         | 73/4830 [02:07<2:34:39,  1.95s/it]  2%|▏         | 74/4830 [02:07<2:06:13,  1.59s/it]  2%|▏         | 75/4830 [02:09<2:01:26,  1.53s/it]  2%|▏         | 76/4830 [02:11<2:07:38,  1.61s/it]  2%|▏         | 77/4830 [02:13<2:23:15,  1.81s/it]  2%|▏         | 78/4830 [02:15<2:38:49,  2.01s/it]  2%|▏         | 79/4830 [02:17<2:17:24,  1.74s/it]  2%|▏         | 80/4830 [02:18<2:14:55,  1.70s/it]  2%|▏         | 81/4830 [02:22<3:12:10,  2.43s/it]  2%|▏         | 82/4830 [02:25<3:30:03,  2.65s/it]  2%|▏         | 83/4830 [02:30<4:13:35,  3.21s/it]  2%|▏         | 84/4830 [02:35<5:02:06,  3.82s/it]  2%|▏         | 85/4830 [02:38<4:30:31,  3.42s/it]  2%|▏         | 86/4830 [02:41<4:26:26,  3.37s/it]  2%|▏         | 87/4830 [02:46<5:09:55,  3.92s/it]  2%|▏         | 88/4830 [02:51<5:23:55,  4.10s/it]  2%|▏         | 89/4830 [02:56<5:51:13,  4.44s/it]  2%|▏         | 90/4830 [02:59<5:25:46,  4.12s/it]  2%|▏         | 91/4830 [03:03<5:11:29,  3.94s/it]  2%|▏         | 92/4830 [03:05<4:34:09,  3.47s/it]  2%|▏         | 93/4830 [03:08<4:24:36,  3.35s/it]